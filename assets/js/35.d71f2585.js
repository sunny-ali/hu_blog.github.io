(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{517:function(s,a,n){"use strict";n.r(a);var e=n(4),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("现在大多项目都是采用前后台分离开发，前端必然会向后台发送接口请求，当需要访问多个接口时，可对该功能模块进行封装，一次封装可以在不同组件调用ajax请求，减少重复代码")]),s._v(" "),n("p",[s._v("首先"),n("strong",[s._v("引入axios")]),s._v("模块，然后通过 export default去对外暴露ajax模块，传递url、data和type这三个值，"),n("strong",[s._v("返回new Promise对象")]),s._v("。执行异步的ajax 请求，然后根据type的值判断请求方式并返回不同的promise，根据axios的二个方法then(成功),catch(异常)去调用new Promise实例对象的resolve(成功)与reject(异常失败)回调函数。代码如下所示：\n封装axios定义ajax请求函数模块\najax.js:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("import axios from 'axios'\nimport {message} from \"antd\";\n\nexport default function ajax(url,data={},type='GET') {\n  return new Promise((resolve, reject)=>{\n    let promise\n\n    if(type==='GET'){\n    promise = axios.get(url,{\n      params:data//指定请求参数\n    })\n  }else{\n    promise = axios.post(url,data)\n  }\n  //如果成功了，调用resolve(value)\n  promise.then(response =>{\n    resolve(response.data)\n    //如果失败了调用reject(reason),而是提示异常信息\n  }).catch(error=>{\n    //reject(error)\n    message.error('请求出错了:'+error.message)\n   })\n  })\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("p",[s._v("封装接口请求模块\nindex.js")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("import ajax from './ajax'//引入封装好的ajax模块\nimport {message} from 'antd' //消息通知\n\n//登录\nexport const reqLogin = (username, password) => ajax(BASE + '/login', {username, password}, 'POST')\n\n//获取信息列表\nexport const reqMessages = () => ajax(BASE +'/messages')\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("对于json请求的接口请求函数也是同样的方法")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("export const reqWeather = (city) => {\n\n  return new Promise((resolve, reject) => {\n    const url = `http://api.map.baidu.com/telematics/v3/weather?location=${city}&output=json&ak=xxx..........`\n    // 发送jsonp请求\n    jsonp(url, {}, (err, data) => {\n     // 如果成功了\n      if (!err && data.status==='success') {\n        // 取出需要的数据\n        const {temperature, weather} = data.results[0].weather_data[0]\n        //调用promise对象的成功回调函数resolve\n        resolve({temperature, weather})\n      } else {\n        // 如果失败了 不调用promise的失败函数 直接提示\n        message.error('获取天气信息失败!')\n      }\n    })\n  })\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("p",[s._v("附上axios库文档地址："),n("a",{attrs:{href:"https://github.com/axios/axios",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/axios/axios"),n("OutboundLink")],1),s._v("\njsonp库文档地址："),n("a",{attrs:{href:"https://github.com/webmodules/jsonp",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/webmodules/jsonp"),n("OutboundLink")],1),s._v("\n以上如有不对之处，恳请各位大佬指教！")])])}),[],!1,null,null,null);a.default=r.exports}}]);